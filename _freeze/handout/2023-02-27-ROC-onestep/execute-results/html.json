{
  "hash": "2c1646fd98785b22da98d8e69c555fee",
  "result": {
    "markdown": "---\ntitle: \"Tidymodels\"\nsubtitle: \"Math 150 - Spring 2023\"\nauthor: \"Jo Hardin\"\nfooter: \"[https://m150-method-biostat.netlify.app/](https://m150-method-biostat.netlify.app/)\"\nlogo: \"../images/st47s.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: true\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\nexecute:\n  freeze: auto\nfrom: markdown+emoji\n---\n\n\n\n\n## Agenda\n\n::: nonincremental\n-   Metric: Receiver Operating Characteristic (ROC) Curves\n-   Metrics: AIC & BIC\n-   Model building one variables at a time\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n# Data & goal\n\n-   Data: <a href = \"https://feederwatch.org/explore/raw-dataset-requests/\" target = \"_blank\">Project FeederWatch</a>#TidyTuesday dataset on Project FeederWatch, a citizen science project for bird science, by way of <a href = \"https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-01-10\" target = \"_blank\">TidyTuesday</a>.\n\n-   Which variables do the best job of modeling whether a bird feeder site will be used by squirrels?\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\nRows: 235,685\nColumns: 59\n$ squirrels                    <fct> no squirrels, no squirrels, no squirrels,…\n$ yard_type_pavement           <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ yard_type_garden             <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ yard_type_landsca            <dbl> 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1,…\n$ yard_type_woods              <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ yard_type_desert             <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ hab_dcid_woods               <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, NA, NA,…\n$ hab_evgr_woods               <dbl> NA, NA, NA, NA, 0, 0, NA, NA, NA, NA, NA,…\n$ hab_mixed_woods              <dbl> 1, 1, 1, 1, 1, 1, NA, NA, NA, NA, 1, 1, 1…\n$ hab_orchard                  <dbl> NA, NA, NA, NA, 0, 0, NA, NA, NA, NA, NA,…\n$ hab_park                     <dbl> NA, NA, NA, NA, 0, 0, NA, NA, NA, NA, 1, …\n$ hab_water_fresh              <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ hab_water_salt               <dbl> NA, NA, NA, NA, 0, 0, NA, NA, NA, NA, 1, …\n$ hab_residential              <dbl> 1, 1, 1, 1, 1, 1, NA, NA, NA, NA, 1, 1, 1…\n$ hab_industrial               <dbl> NA, NA, NA, NA, 0, 0, NA, NA, NA, NA, 1, …\n$ hab_agricultural             <dbl> 1, 1, 1, 1, 1, 1, NA, NA, NA, NA, 1, 1, 1…\n$ hab_desert_scrub             <dbl> NA, NA, NA, NA, 0, 0, NA, NA, NA, NA, NA,…\n$ hab_young_woods              <dbl> NA, NA, NA, NA, 0, 0, NA, NA, NA, NA, NA,…\n$ hab_swamp                    <dbl> NA, NA, NA, NA, 0, 0, NA, NA, NA, NA, NA,…\n$ hab_marsh                    <dbl> 1, 1, 1, 1, 1, 1, NA, NA, NA, NA, 1, 1, 1…\n$ evgr_trees_atleast           <dbl> 11, 11, 11, 11, 11, 11, 0, 0, 0, 4, 1, 1,…\n$ evgr_shrbs_atleast           <dbl> 4, 4, 4, 4, 1, 1, 1, 1, 1, 1, 4, 4, 4, 4,…\n$ dcid_trees_atleast           <dbl> 11, 11, 11, 11, 1, 1, 11, 11, 11, 11, 4, …\n$ dcid_shrbs_atleast           <dbl> 4, 4, 4, 4, 4, 4, 11, 11, 11, 11, 4, 4, 4…\n$ fru_trees_atleast            <dbl> 4, 4, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ cacti_atleast                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ brsh_piles_atleast           <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ water_srcs_atleast           <dbl> 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ bird_baths_atleast           <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1,…\n$ nearby_feeders               <dbl> 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1,…\n$ cats                         <dbl> 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1,…\n$ dogs                         <dbl> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1,…\n$ humans                       <dbl> 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1,…\n$ housing_density              <dbl> 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 2, 2,…\n$ fed_in_jan                   <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, 1, N…\n$ fed_in_feb                   <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, 1, N…\n$ fed_in_mar                   <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, 1, N…\n$ fed_in_apr                   <dbl> 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, NA, 0, N…\n$ fed_in_may                   <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, NA, 0, N…\n$ fed_in_jun                   <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, NA, 0, N…\n$ fed_in_jul                   <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, NA, 0, N…\n$ fed_in_aug                   <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, NA, 0, N…\n$ fed_in_sep                   <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, NA, 0, N…\n$ fed_in_oct                   <dbl> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, NA, 1, N…\n$ fed_in_nov                   <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, 1, N…\n$ fed_in_dec                   <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, 1, N…\n$ numfeeders_suet              <dbl> 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 1, 1, 1, 2,…\n$ numfeeders_ground            <dbl> NA, 0, 0, 0, NA, NA, 1, 1, 1, 1, 3, 3, 3,…\n$ numfeeders_hanging           <dbl> 1, 1, 1, 3, NA, NA, 2, 2, 2, 2, 2, 2, 1, …\n$ numfeeders_platfrm           <dbl> 1, 1, 1, 0, NA, NA, 1, 1, 1, 2, 1, 1, 1, …\n$ numfeeders_humming           <dbl> NA, 0, 0, 0, NA, NA, 1, 1, 1, 1, NA, 0, 0…\n$ numfeeders_water             <dbl> 1, 1, 1, 1, NA, NA, 2, 2, 2, 2, 1, 1, 1, …\n$ numfeeders_thistle           <dbl> NA, 0, 0, 0, NA, NA, 1, 1, 1, 2, 1, 1, 1,…\n$ numfeeders_fruit             <dbl> NA, 0, 0, 0, NA, NA, 1, 1, 1, 1, NA, 0, 0…\n$ numfeeders_hopper            <dbl> NA, NA, NA, NA, 1, 1, NA, NA, NA, NA, NA,…\n$ numfeeders_tube              <dbl> NA, NA, NA, NA, 1, 1, NA, NA, NA, NA, NA,…\n$ numfeeders_other             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ population_atleast           <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5001, 5001,…\n$ count_area_size_sq_m_atleast <dbl> 1.01, 1.01, 1.01, 1.01, 1.01, 1.01, 375.0…\n```\n:::\n:::\n\n\n\n# Modeling\n\nFor illustrative purposes, we go back to test/training model, although ROC can and should be used within a cross validation framework.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 59 × 5\n   term               estimate std.error statistic   p.value\n   <chr>                 <dbl>     <dbl>     <dbl>     <dbl>\n 1 (Intercept)         -1.42      0.0505    -28.2  2.26e-174\n 2 yard_type_pavement  -0.854     0.149      -5.74 9.23e-  9\n 3 yard_type_garden    -0.175     0.0392     -4.47 7.89e-  6\n 4 yard_type_landsca    0.168     0.0219      7.69 1.45e- 14\n 5 yard_type_woods      0.309     0.0170     18.1  1.59e- 73\n 6 yard_type_desert    -0.297     0.0789     -3.76 1.68e-  4\n 7 hab_dcid_woods       0.336     0.0161     20.9  6.55e- 97\n 8 hab_evgr_woods      -0.0797    0.0192     -4.15 3.36e-  5\n 9 hab_mixed_woods      0.420     0.0158     26.5  3.17e-155\n10 hab_orchard         -0.307     0.0252    -12.2  4.00e- 34\n# … with 49 more rows\n```\n:::\n:::\n\n\n\n\n# Evaluate model\n\n> sensitivty = number of squirrels that are accurately predicted to be squirrels (true positive rate)\n\n> specificity = number of non-squirrels that are accurately predicted to be non-squirrels (true negative rate)\n\n## Make predictions for test data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfeeder_test_pred <- predict(feeder_fit, feeder_test, type = \"prob\") %>%\n  mutate(.pred_class = as.factor(ifelse(.pred_squirrels >=0.5,\n                                        \"squirrels\", \"no squirrels\"))) %>%\n  bind_cols(feeder_test %>% select(squirrels))\n\nfeeder_test_pred\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 58,922 × 4\n   `.pred_no squirrels` .pred_squirrels .pred_class squirrels   \n                  <dbl>           <dbl> <fct>       <fct>       \n 1               0.201            0.799 squirrels   no squirrels\n 2               0.156            0.844 squirrels   no squirrels\n 3               0.352            0.648 squirrels   no squirrels\n 4               0.197            0.803 squirrels   squirrels   \n 5               0.121            0.879 squirrels   squirrels   \n 6               0.272            0.728 squirrels   squirrels   \n 7               0.0459           0.954 squirrels   squirrels   \n 8               0.0341           0.966 squirrels   squirrels   \n 9               0.0631           0.937 squirrels   squirrels   \n10               0.0312           0.969 squirrels   squirrels   \n# … with 58,912 more rows\n```\n:::\n:::\n\n\n## Accuracy\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrbind(accuracy(feeder_test_pred, truth = squirrels, \n               estimate = .pred_class),\n      sensitivity(feeder_test_pred, truth = squirrels, \n                  estimate = .pred_class, event_level = \"second\"),\n      specificity(feeder_test_pred, truth = squirrels, \n                  estimate = .pred_class, event_level = \"second\"),\n      roc_auc(feeder_test_pred, truth = squirrels, \n                  estimate = .pred_squirrels, event_level = \"second\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 3\n  .metric     .estimator .estimate\n  <chr>       <chr>          <dbl>\n1 accuracy    binary        0.814 \n2 sensitivity binary        0.985 \n3 specificity binary        0.0988\n4 roc_auc     binary        0.721 \n```\n:::\n:::\n\n\n## ROC Curves\n\nReceiver Operating Characteristic Curves \n\n* TPR = sensitivity = # of true predicted true / # true\n* FPR = 1 - specificity = # false predicted true / # false\n\nHow can the plot use many TPRs and FPRs ???\n\n## ROC Curve\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2023-02-27-ROC-onestep_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n## Visualizing accuracy\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 3\n  .metric     .estimator .estimate\n  <chr>       <chr>          <dbl>\n1 accuracy    binary        0.814 \n2 sensitivity binary        0.985 \n3 specificity binary        0.0988\n4 roc_auc     binary        0.721 \n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2023-02-27-ROC-onestep_files/figure-revealjs/unnamed-chunk-9-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n## Different cut-off = 0.8?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfeeder_test_pred <- predict(feeder_fit, feeder_test, type = \"prob\") %>%\n  mutate(.pred_class = as.factor(ifelse(.pred_squirrels >=0.8,\n                                        \"squirrels\", \"no squirrels\"))) %>%\n  bind_cols(feeder_test %>% select(squirrels))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 3\n  .metric     .estimator .estimate\n  <chr>       <chr>          <dbl>\n1 accuracy    binary         0.675\n2 sensitivity binary         0.683\n3 specificity binary         0.641\n4 roc_auc     binary         0.721\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2023-02-27-ROC-onestep_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n\n## Different cut-off = 0.15?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfeeder_test_pred <- predict(feeder_fit, feeder_test, type = \"prob\") %>%\n  mutate(.pred_class = as.factor(ifelse(.pred_squirrels >=0.15,\n                                        \"squirrels\", \"no squirrels\"))) %>%\n  bind_cols(feeder_test %>% select(squirrels))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 3\n  .metric     .estimator .estimate\n  <chr>       <chr>          <dbl>\n1 accuracy    binary       0.807  \n2 sensitivity binary       0.999  \n3 specificity binary       0.00141\n4 roc_auc     binary       0.721  \n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](2023-02-27-ROC-onestep_files/figure-revealjs/unnamed-chunk-15-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n## ROC Curve\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nroc_auc(feeder_test_pred, truth = squirrels, \n                  estimate = .pred_squirrels, event_level = \"second\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 roc_auc binary         0.721\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![To get a single value (for model comparison), we use the area under the ROC curve.](2023-02-27-ROC-onestep_files/figure-revealjs/unnamed-chunk-17-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n## AOC\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Alexandria Ocasio-Cortez as Area Over the Curve.  I didn't make the image, and I don't know who did!](figs/aoc.jpg){fig-align='center' fig-alt='A play on words, the image show Alexandria Ocasio-Cortez, who is also known as AOC, as the area over the ROC curve.  The area under the curve is commonly known as AUC, so the area over it would be AOC.' width=90%}\n:::\n:::\n\n\n## More metrics\n\n* AIC: Akaike's Information Criteria = $-2\\ln L + 2p$\n\n* BIC: Bayesian Information Criteria = $-2 \\ln L + p \\ln(n)$\n\n> choose a model with the smallest AIC or BIC\n\n# Variable Selection\n\n> Forward: start with the \"best\" variable and add variables one at a time\n\n> Backward: start with the full model and remove variables one at a time\n\n> Best: find the \"best\" combo of variables (check them all!) for a specified number of variables\n\n## Tools :confounded:\n\n* **tidymodels** does not make it easy to add or drop 1 variable at a time.\n\n* `add1()` and `drop1()` functions do not make it easy to work with dozens of predictors and missing data.\n\nTherefore, we'll go back to the bird data from HW 5.\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\nLocation\n  bank  conif  decid ground  shrub   snag   wall \n     3     14     25     19     17      4      4 \n```\n:::\n:::\n\n\n\n## Forward +1\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ 1, data = nests, family=\"binomial\") %>%\n  add1(scope = ~ Length + Location + No.eggs + Color +\n         Incubate + Nestling + Totcare, test = \"Chisq\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSingle term additions\n\nModel:\n`Closed?` ~ 1\n         Df Deviance     AIC     LRT  Pr(>Chi)    \n<none>       108.533 110.533                      \nLength    1  105.296 109.296  3.2373 0.0719792 .  \nLocation  6   77.065  91.065 31.4684 2.063e-05 ***\nNo.eggs   1   90.951  94.951 17.5816 2.752e-05 ***\nColor     1  108.087 112.087  0.4463 0.5041175    \nIncubate  1  108.267 112.267  0.2658 0.6061875    \nNestling  1   93.825  97.825 14.7078 0.0001255 ***\nTotcare   1   98.964 102.964  9.5688 0.0019791 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Forward +2\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ Location, data = nests, family=\"binomial\") %>%\n  add1(scope = ~ Length + Location + No.eggs + Color +\n         Incubate + Nestling + Totcare, test = \"Chisq\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSingle term additions\n\nModel:\n`Closed?` ~ Location\n         Df Deviance    AIC     LRT  Pr(>Chi)    \n<none>        77.065 91.065                      \nLength    1   71.704 87.704  5.3605    0.0206 *  \nNo.eggs   1   61.211 77.211 15.8530 6.846e-05 ***\nColor     1   74.758 90.758  2.3070    0.1288    \nIncubate  1   74.829 90.829  2.2355    0.1349    \nNestling  1   74.722 90.722  2.3425    0.1259    \nTotcare   1   76.635 92.635  0.4300    0.5120    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n## Forward +3\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ No.eggs + Location, data = nests, family=\"binomial\") %>%\n  add1(scope = ~ Length + Location + No.eggs + Color +\n         Incubate + Nestling + Totcare, test = \"Chisq\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSingle term additions\n\nModel:\n`Closed?` ~ No.eggs + Location\n         Df Deviance    AIC     LRT Pr(>Chi)  \n<none>        61.211 77.211                   \nLength    1   58.229 76.229 2.98230  0.08418 .\nColor     1   59.925 77.925 1.28650  0.25669  \nIncubate  1   59.891 77.891 1.32019  0.25056  \nNestling  1   59.247 77.247 1.96461  0.16102  \nTotcare   1   60.751 78.751 0.46084  0.49723  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n## Backward -1 \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ Length + Location + No.eggs + Color +\n         Incubate + Nestling + Totcare, data = nests, family=\"binomial\") %>%\n  drop1(test = \"Chisq\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSingle term deletions\n\nModel:\n`Closed?` ~ Length + Location + No.eggs + Color + Incubate + \n    Nestling + Totcare\n         Df Deviance    AIC     LRT Pr(>Chi)   \n<none>        46.252 70.252                    \nLength    1   52.812 74.812  6.5600 0.010430 * \nLocation  6   66.017 78.017 19.7648 0.003049 **\nNo.eggs   1   56.049 78.049  9.7973 0.001748 **\nColor     1   46.997 68.997  0.7457 0.387857   \nIncubate  0   46.252 70.252  0.0000            \nNestling  0   46.252 70.252  0.0000            \nTotcare   0   46.252 70.252  0.0000            \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Backward -2 \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ Length + Location + No.eggs + Color +\n         Incubate  + Totcare, data = nests, family=\"binomial\") %>%\n  drop1(test = \"Chisq\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSingle term deletions\n\nModel:\n`Closed?` ~ Length + Location + No.eggs + Color + Incubate + \n    Totcare\n         Df Deviance    AIC     LRT Pr(>Chi)   \n<none>        46.252 70.252                    \nLength    1   52.812 74.812  6.5600 0.010430 * \nLocation  6   66.017 78.017 19.7648 0.003049 **\nNo.eggs   1   56.049 78.049  9.7973 0.001748 **\nColor     1   46.997 68.997  0.7457 0.387857   \nIncubate  1   49.031 71.031  2.7796 0.095472 . \nTotcare   1   56.989 78.989 10.7368 0.001050 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Backward -2 \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ Length + Location + No.eggs + Incubate  + Totcare, \n    data = nests, family=\"binomial\") %>%\n  drop1(test = \"Chisq\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSingle term deletions\n\nModel:\n`Closed?` ~ Length + Location + No.eggs + Incubate + Totcare\n         Df Deviance    AIC     LRT Pr(>Chi)    \n<none>        46.997 68.997                     \nLength    1   53.878 73.878  6.8809 0.008712 ** \nLocation  6   66.664 76.664 19.6663 0.003175 ** \nNo.eggs   1   57.418 77.418 10.4201 0.001247 ** \nIncubate  1   49.839 69.839  2.8416 0.091854 .  \nTotcare   1   58.227 78.227 11.2297 0.000805 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n## Backward -3 \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ Length + Location + No.eggs + Totcare, \n    data = nests, family=\"binomial\") %>%\n  drop1(test = \"Chisq\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSingle term deletions\n\nModel:\n`Closed?` ~ Length + Location + No.eggs + Totcare\n         Df Deviance    AIC     LRT  Pr(>Chi)    \n<none>        49.839 69.839                      \nLength    1   60.751 78.751 10.9116 0.0009556 ***\nLocation  6   69.236 77.236 19.3974 0.0035425 ** \nNo.eggs   1   61.940 79.940 12.1013 0.0005039 ***\nTotcare   1   58.229 76.229  8.3902 0.0037725 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n\n## Automatic: Forward w AIC\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ 1, data = nests, family=\"binomial\") %>%\n  stats::step(scope = ~ Length + Location + No.eggs + Color +\n         Incubate + Nestling + Totcare, \n         direction = \"forward\", k = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStart:  AIC=110.53\n`Closed?` ~ 1\n\n           Df Deviance     AIC\n+ Location  6   77.065  91.065\n+ No.eggs   1   90.951  94.951\n+ Nestling  1   93.825  97.825\n+ Totcare   1   98.964 102.964\n+ Length    1  105.296 109.296\n<none>         108.533 110.533\n+ Color     1  108.087 112.087\n+ Incubate  1  108.267 112.267\n\nStep:  AIC=91.06\n`Closed?` ~ Location\n\n           Df Deviance    AIC\n+ No.eggs   1   61.211 77.211\n+ Length    1   71.704 87.704\n+ Nestling  1   74.722 90.722\n+ Color     1   74.758 90.758\n+ Incubate  1   74.829 90.829\n<none>          77.065 91.065\n+ Totcare   1   76.635 92.635\n\nStep:  AIC=77.21\n`Closed?` ~ Location + No.eggs\n\n           Df Deviance    AIC\n+ Length    1   58.229 76.229\n<none>          61.211 77.211\n+ Nestling  1   59.247 77.247\n+ Incubate  1   59.891 77.891\n+ Color     1   59.925 77.925\n+ Totcare   1   60.751 78.751\n\nStep:  AIC=76.23\n`Closed?` ~ Location + No.eggs + Length\n\n           Df Deviance    AIC\n+ Nestling  1   47.292 67.292\n+ Totcare   1   49.839 69.839\n<none>          58.229 76.229\n+ Color     1   56.989 76.989\n+ Incubate  1   58.227 78.227\n\nStep:  AIC=67.29\n`Closed?` ~ Location + No.eggs + Length + Nestling\n\n           Df Deviance    AIC\n<none>          47.292 67.292\n+ Color     1   46.580 68.580\n+ Incubate  1   46.997 68.997\n+ Totcare   1   46.997 68.997\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = `Closed?` ~ Location + No.eggs + Length + Nestling, \n    family = \"binomial\", data = nests)\n\nCoefficients:\n   (Intercept)   Locationconif   Locationdecid  Locationground   Locationshrub  \n       11.1085        -19.2865        -16.8603        -20.5222        -18.6448  \n  Locationsnag    Locationwall         No.eggs          Length        Nestling  \n        0.6949        -18.3127          0.7950         -0.2194          0.3983  \n\nDegrees of Freedom: 85 Total (i.e. Null);  76 Residual\nNull Deviance:\t    108.5 \nResidual Deviance: 47.29 \tAIC: 67.29\n```\n:::\n:::\n\n\n## Final Forward AIC\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ Length + Location + No.eggs + Nestling,\n    data = nests, family=\"binomial\") %>% tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 5\n   term           estimate std.error statistic p.value\n   <chr>             <dbl>     <dbl>     <dbl>   <dbl>\n 1 (Intercept)      11.1   3328.      0.00334  0.997  \n 2 Length           -0.219    0.0754 -2.91     0.00364\n 3 Locationconif   -19.3   3328.     -0.00580  0.995  \n 4 Locationdecid   -16.9   3328.     -0.00507  0.996  \n 5 Locationground  -20.5   3328.     -0.00617  0.995  \n 6 Locationshrub   -18.6   3328.     -0.00560  0.996  \n 7 Locationsnag      0.695 4313.      0.000161 1.00   \n 8 Locationwall    -18.3   3328.     -0.00550  0.996  \n 9 No.eggs           0.795    0.262   3.04     0.00238\n10 Nestling          0.398    0.144   2.76     0.00577\n```\n:::\n:::\n\n\n\n## Automatic: Backward w BIC\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ Length + Location + No.eggs + Color +\n         Incubate + Nestling + Totcare,\n    data = nests, family=\"binomial\") %>%\n  stats::step(scope = ~ Length + Location + No.eggs + Color +\n         Incubate + Nestling + Totcare, \n         direction = \"backward\", k = log(86))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStart:  AIC=99.7\n`Closed?` ~ Length + Location + No.eggs + Color + Incubate + \n    Nestling + Totcare\n\n\nStep:  AIC=99.7\n`Closed?` ~ Length + Location + No.eggs + Color + Incubate + \n    Nestling\n\n           Df Deviance     AIC\n- Location  6   66.017  92.743\n- Incubate  1   46.580  95.577\n- Color     1   46.997  95.995\n<none>          46.252  99.704\n- Length    1   52.812 101.810\n- No.eggs   1   56.049 105.047\n- Nestling  1   56.989 105.986\n\nStep:  AIC=92.74\n`Closed?` ~ Length + No.eggs + Color + Incubate + Nestling\n\n           Df Deviance     AIC\n- Incubate  1   66.175  88.447\n- Color     1   66.664  88.935\n<none>          66.017  92.743\n- No.eggs   1   74.635  96.907\n- Length    1   75.000  97.272\n- Nestling  1   85.891 108.163\n\nStep:  AIC=88.45\n`Closed?` ~ Length + No.eggs + Color + Nestling\n\n           Df Deviance     AIC\n- Color     1   66.762  84.579\n<none>          66.175  88.447\n- No.eggs   1   75.577  93.395\n- Length    1   79.115  96.932\n- Nestling  1   89.064 106.881\n\nStep:  AIC=84.58\n`Closed?` ~ Length + No.eggs + Nestling\n\n           Df Deviance     AIC\n<none>          66.762  84.579\n- No.eggs   1   76.704  90.067\n- Length    1   79.162  92.525\n- Nestling  1   90.053 103.416\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = `Closed?` ~ Length + No.eggs + Nestling, family = \"binomial\", \n    data = nests)\n\nCoefficients:\n(Intercept)       Length      No.eggs     Nestling  \n    -6.7711      -0.1871       0.6476       0.4062  \n\nDegrees of Freedom: 85 Total (i.e. Null);  82 Residual\nNull Deviance:\t    108.5 \nResidual Deviance: 66.76 \tAIC: 74.76\n```\n:::\n:::\n\n\n\n## Final Backward BIC\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(`Closed?` ~ Length + No.eggs + Nestling,\n    data = nests, family=\"binomial\") %>% tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 5\n  term        estimate std.error statistic   p.value\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)   -6.77     1.73       -3.90 0.0000946\n2 Length        -0.187    0.0598     -3.13 0.00177  \n3 No.eggs        0.648    0.245       2.65 0.00815  \n4 Nestling       0.406    0.107       3.78 0.000156 \n```\n:::\n:::\n",
    "supporting": [
      "2023-02-27-ROC-onestep_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}